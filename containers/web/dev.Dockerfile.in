FROM ci.int.centreon.com:5000/mon-web-stable:centos@CENTOS_VERSION@
MAINTAINER Alexandre Fouille <afouille@centreon.com>

# Prepare environment for autoinstall.
COPY centreon /tmp/centreon
COPY web/autoinstall.php /usr/share/centreon/autoinstall.php

# Install script (web-wizard install).
COPY web/dev.sh /tmp/install.sh
COPY web/vars /tmp/vars
COPY update-centreon.php /tmp/update-centreon.php
RUN chmod +x /tmp/install.sh
RUN /tmp/install.sh

# Main script.
COPY web/run.sh /usr/share/centreon/container.sh
RUN chmod +x /usr/share/centreon/container.sh
ENTRYPOINT /usr/share/centreon/container.sh
