FROM ci.int.centreon.com:5000/mon-middleware:@DISTRIB@
MAINTAINER Matthieu Kermagoret <mkermagoret@centreon.com>

# npm packages.
COPY centreon-imp-portal-api/package.json /usr/local/src/centreon-imp-portal-api/package.json
RUN npm install

# Compose packages.
COPY centreon-imp-portal-api/composer.json /usr/local/src/centreon-imp-portal-api/composer.json
RUN composer install
RUN composer update

# Database.
COPY centreon-imp-portal-api/database/create.sql /usr/local/src/centreon-imp-portal-api/database/create.sql
RUN /tmp/install.sh

# Static sources.
COPY centreon-imp-portal-api/lib /usr/local/src/centreon-imp-portal-api/lib
COPY centreon-imp-portal-api/localserver /usr/local/src/centreon-imp-portal-api/localserver
