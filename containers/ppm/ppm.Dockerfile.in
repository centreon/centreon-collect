# Base information.
FROM ci.int.centreon.com:5000/mon-web:@DISTRIB@
MAINTAINER Matthieu Kermagoret <mkermagoret@centreon.com>

# Set middleware server.
ENV CENTREON_IMP_SERVER HELLOWORLD:http://ci.int.centreon.com:3000/api

# Install package.
RUN yum --disablerepo='*' --enablerepo='centreon-internal*' clean all
RUN yum install -y --nogpgcheck centreon-pp-manager

# Install Plugin Pack JSON files.
COPY middleware/data/*.json /usr/share/centreon-packs/

# Install module in Centreon.
COPY install-centreon-module.php /tmp/install-centreon-module.php
COPY ppm/install.sh /tmp/install.sh
RUN chmod +x /tmp/install-centreon-module.php /tmp/install.sh
RUN /tmp/install.sh
