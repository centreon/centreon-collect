{
    "commands": [
        {
            "line": "\\\"$CENTREONPLUGINS$\\\\/centreon_protocol_x509.pl --plugin=apps::protocols::x509::plugin --mode=validity --hostname=$HOSTADDRESS$ --port=$_SERVICEPORT$ --validity-mode=issuer --issuername=$_SERVICEISSUERCONTENT$ $_SERVICEEXTRAOPTIONS$\\\"",
            "name": "App-Protocol-X509-Issuer",
            "type": 2
        },
        {
            "line": "\\\"$CENTREONPLUGINS$\\\\/centreon_protocol_x509.pl --plugin=apps::protocols::x509::plugin --mode=validity --hostname=$HOSTADDRESS$ --port=$_SERVICEPORT$ --validity-mode=subject --subjectname=$_SERVICESUBJECTCONTENT$ $_SERVICEEXTRAOPTIONS$\\\"",
            "name": "App-Protocol-X509-Subject",
            "type": 2
        },
        {
            "line": "\\\"$CENTREONPLUGINS$\\\\/centreon_protocol_x509.pl --plugin=apps::protocols::x509::plugin --mode=validity --hostname=$HOSTADDRESS$ --port=$_SERVICEPORT$ --validity-mode=expiration --warning-date=$_SERVICEWARNING$ --critical-date=$_SERVICECRITICAL$ $_SERVICEEXTRAOPTIONS$\\\"",
            "name": "App-Protocol-X509-Expiration",
            "type": 2
        }
    ],
    "host_templates": [
        {
            "active_checks_enabled": 2,
            "alias": "Template to check a X509's certificate",
            "check_interval": 0,
            "checks_enabled": 2,
            "discovery_validator": "",
            "icon": "",
            "macros": [],
            "max_check_attempts": 0,
            "name": "App-Protocol-X509",
            "parent_template": [
                "generic-active-host"
            ],
            "passive_checks_enabled": 2,
            "services": [
                "App-Protocol-X509-Expiration"
            ]
        }
    ],
    "images": [],
    "information": {
        "author": "Centreon",
        "changelog": "* Update relation between HTPL and STPL\r\n* Correct name of HTPL to use in monitoring procedure",
        "dependencies": [
            {
                "name": "base-generic",
                "version": "3.0.0"
            }
        ],
        "description": [
            {
                "lang": "en",
                "value": "Plugin pack to monitor  a public key infrastructure (PKI) \r\n* Element of the issuer name of a X509\\'s certificate\r\n* Element of the subject name of a X509\\'s certificate\r\n* Expiration"
            },
            {
                "lang": "fr",
                "value": "Plugin pack pour surveiller une infrastructure \u00e0 cl\u00e9s publiques (PKI)\r\n* El\u00e9ment dans le nom du d\u00e9livreur d\\'un certificat X509\r\n* El\u00e9ment dans le DN du d\u00e9tenteur d\\'un certificat X509\r\n* Expiration"
            }
        ],
        "discovery_category": "protocol",
        "email": "imp@centreon.com",
        "icon": "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",
        "monitoring_procedure": "# Monitoring procedure\r\n## Prerequisites\r\nThis chapter describes the prerequisites installation needed by plugins\r\nto run.\r\n\r\n### Remote server\r\nThe remote server must have an X509's certificate.\r\n\r\n## Centreon Configuration\r\n### Create a host using the appropriate template\r\nGo to *Configuration &gt; Hosts* and click *Add*. Then, fill the form as\r\nshown by the following table:\r\n\r\n<table>\r\n<colgroup>\r\n<col width=\"58%\" />\r\n<col width=\"41%\" />\r\n</colgroup>\r\n<thead>\r\n<tr class=\"header\">\r\n<th align=\"left\">Field</th>\r\n<th align=\"left\">Value</th>\r\n</tr>\r\n</thead>\r\n<tbody>\r\n<tr class=\"odd\">\r\n<td align=\"left\"><p>Host name</p></td>\r\n<td align=\"left\"><p><em>Name of the host</em></p></td>\r\n</tr>\r\n<tr class=\"even\">\r\n<td align=\"left\"><p>Alias</p></td>\r\n<td align=\"left\"><p><em>Host description</em></p></td>\r\n</tr>\r\n<tr class=\"odd\">\r\n<td align=\"left\"><p>IP</p></td>\r\n<td align=\"left\"><p><em>Host IP Address</em></p></td>\r\n</tr>\r\n<tr class=\"even\">\r\n<td align=\"left\"><p>Monitored from</p></td>\r\n<td align=\"left\"><p><em>Monitoring Poller to use</em></p></td>\r\n</tr>\r\n<tr class=\"odd\">\r\n<td align=\"left\"><p>Host Multiple Templates</p></td>\r\n<td align=\"left\"><p>App-Protocol-X509-custom</p></td>\r\n</tr>\r\n<tr class=\"even\">\r\n<td align=\"left\"><p>Onglet <em>Relations</em> &gt; Parent Hostgroups</p></td>\r\n<td align=\"left\"></td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n\r\nClick on the *Save* button.\r\n\r\nThis service was automatically created for this host:\r\n\r\n<table>\r\n<colgroup>\r\n<col width=\"29%\" />\r\n<col width=\"65%\" />\r\n</colgroup>\r\n<thead>\r\n<tr class=\"header\">\r\n<th align=\"left\">Service</th>\r\n<th align=\"left\">Description</th>\r\n</tr>\r\n</thead>\r\n<tbody>\r\n<tr class=\"odd\">\r\n<td align=\"left\"><p>X509-Expiration</p></td>\r\n<td align=\"left\"><p>Monitor expiration date of a X509's certificate</p></td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n\r\n<table>\r\n<colgroup>\r\n<col width=\"34%\" />\r\n<col width=\"65%\" />\r\n</colgroup>\r\n<thead>\r\n<tr class=\"header\">\r\n<th align=\"left\">Optionnal Service</th>\r\n<th align=\"left\">Description</th>\r\n</tr>\r\n</thead>\r\n<tbody>\r\n<tr class=\"odd\">\r\n<td align=\"left\"><p>X509-Subject</p></td>\r\n<td align=\"left\"><p>Monitor an element of the subject name of a X509's certificate</p></td>\r\n</tr>\r\n<tr class=\"even\">\r\n<td align=\"left\"><p>X509-Issuer</p></td>\r\n<td align=\"left\"><p>Monitor an element of the issuer name of a X509's certificate</p></td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n\r\n### Service Macro Configuration\r\nThe following macros must be configured on service (\\* means mandatory\r\noptions):\r\n\r\n<table>\r\n<colgroup>\r\n<col width=\"20%\" />\r\n<col width=\"47%\" />\r\n<col width=\"19%\" />\r\n<col width=\"13%\" />\r\n</colgroup>\r\n<thead>\r\n<tr class=\"header\">\r\n<th align=\"left\">Macro</th>\r\n<th align=\"left\">Description</th>\r\n<th align=\"left\">Default value</th>\r\n<th align=\"left\">Example</th>\r\n</tr>\r\n</thead>\r\n<tbody>\r\n<tr class=\"odd\">\r\n<td align=\"left\"><p>PORT*</p></td>\r\n<td align=\"left\"><p>Port to connect to server</p></td>\r\n<td align=\"left\"><p>443</p></td>\r\n<td align=\"left\"><p>443</p></td>\r\n</tr>\r\n<tr class=\"even\">\r\n<td align=\"left\"><p>WARNING*</p></td>\r\n<td align=\"left\"><p>Warning Thresold (number of days)</p></td>\r\n<td align=\"left\"><p>60:</p></td>\r\n<td align=\"left\"><p>60:</p></td>\r\n</tr>\r\n<tr class=\"odd\">\r\n<td align=\"left\"><p>CRITICAL*</p></td>\r\n<td align=\"left\"><p>Critical Thresold (number of days)</p></td>\r\n<td align=\"left\"><p>30:</p></td>\r\n<td align=\"left\"><p>30:</p></td>\r\n</tr>\r\n<tr class=\"even\">\r\n<td align=\"left\"><p>ISSUERNAME</p></td>\r\n<td align=\"left\"><p>Content of the issuer name</p></td>\r\n<td align=\"left\"></td>\r\n<td align=\"left\"></td>\r\n</tr>\r\n<tr class=\"odd\">\r\n<td align=\"left\"><p>OBJECTNAME</p></td>\r\n<td align=\"left\"><p>Content of the object name</p></td>\r\n<td align=\"left\"></td>\r\n<td align=\"left\"></td>\r\n</tr>\r\n</tbody>\r\n</table>",
        "name": "X509 Certificat",
        "requirement": [
            {
                "name": "ces-plugins-Applications-Protocol-X509",
                "version": "20160324-2"
            }
        ],
        "slug": "applications-protocol-x509",
        "status": "stable",
        "status_message": "",
        "tags": [
            "Certificate",
            "Cryptography",
            "PKI",
            "SSL",
            "TLS",
            "X.509",
            "X509"
        ],
        "update_date": "1465837702",
        "version": "3.0.3",
        "website": "www.centreon.com"
    },
    "service_templates": [
        {
            "_comment": "{FR: Contr",
            "active_checks_enabled": 2,
            "alias": "X509-Expiration",
            "command_name": "App-Protocol-X509-Expiration",
            "discovery_list_mode": "",
            "icon": "",
            "is_volatile": 2,
            "macros": [
                {
                    "description": "",
                    "key": "$_SERVICEPORT$",
                    "password": false,
                    "value": "443"
                },
                {
                    "description": "",
                    "key": "$_SERVICEWARNING$",
                    "password": false,
                    "value": "60:"
                },
                {
                    "description": "",
                    "key": "$_SERVICECRITICAL$",
                    "password": false,
                    "value": "30:"
                },
                {
                    "description": "",
                    "key": "$_SERVICEEXTRAOPTIONS$",
                    "password": false,
                    "value": ""
                }
            ],
            "max_check_attempts": 0,
            "name": "App-Protocol-X509-Expiration",
            "normal_check_interval": 0,
            "parent_template": "generic-active-service",
            "passive_checks_enabled": 2,
            "retry_check_interval": 0,
            "timeperiod": ""
        },
        {
            "_comment": "{FR: Contr",
            "active_checks_enabled": 2,
            "alias": "X509-Issuer",
            "command_name": "App-Protocol-X509-Issuer",
            "discovery_list_mode": "",
            "icon": "",
            "is_volatile": 2,
            "macros": [
                {
                    "description": "",
                    "key": "$_SERVICEPORT$",
                    "password": false,
                    "value": "443"
                },
                {
                    "description": "",
                    "key": "$_SERVICEISSUERCONTENT$",
                    "password": false,
                    "value": ""
                },
                {
                    "description": "",
                    "key": "$_SERVICEEXTRAOPTIONS$",
                    "password": false,
                    "value": ""
                }
            ],
            "max_check_attempts": 0,
            "name": "App-Protocol-X509-Issuer",
            "normal_check_interval": 0,
            "parent_template": "generic-active-service",
            "passive_checks_enabled": 2,
            "retry_check_interval": 0,
            "timeperiod": ""
        },
        {
            "_comment": "{FR: Contr",
            "active_checks_enabled": 2,
            "alias": "X509-Subject",
            "command_name": "App-Protocol-X509-Subject",
            "discovery_list_mode": "",
            "icon": "",
            "is_volatile": 2,
            "macros": [
                {
                    "description": "",
                    "key": "$_SERVICEPORT$",
                    "password": false,
                    "value": "443"
                },
                {
                    "description": "",
                    "key": "$_SERVICEEXTRAOPTIONS$",
                    "password": false,
                    "value": ""
                },
                {
                    "description": "",
                    "key": "$_SERVICESUBJECTCONTENT$",
                    "password": false,
                    "value": ""
                }
            ],
            "max_check_attempts": 0,
            "name": "App-Protocol-X509-Subject",
            "normal_check_interval": 0,
            "parent_template": "generic-active-service",
            "passive_checks_enabled": 2,
            "retry_check_interval": 0,
            "timeperiod": ""
        }
    ],
    "timeperiods": {
        "timeperiod": []
    }
}
