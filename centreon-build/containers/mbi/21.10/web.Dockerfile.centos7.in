# Base information.
FROM registry.centreon.com/mon-web-21.10:@DISTRIB@
MAINTAINER Matthieu Kermagoret <mkermagoret@centreon.com>

# Install Centreon business repository.
RUN curl -o centreon-business-release.rpm "https://yum.centreon.com/centreon-business/1a97ff9985262bf3daf7a0919f9c59a6/21.10/el7/stable/noarch/RPMS/centreon-business-release-21.10-1.el7.centos.noarch.rpm"
RUN yum clean all && yum install --nogpgcheck centreon-business-release.rpm

# Install Centreon MBI web interface.
RUN yum clean all && \
    yum install -y centreon-bi-server && \
    yum clean all

# Install license file.
COPY mbi/mbi.license /etc/centreon/license.d/mbi.license

# Install Centreon MBI web interface.
COPY web/21.10/install-centreon-module.php /tmp/install-centreon-module.php
COPY mbi/21.10/install-web.sh /tmp/install.sh
RUN chmod +x /tmp/install-centreon-module.php /tmp/install.sh
RUN /tmp/install.sh
