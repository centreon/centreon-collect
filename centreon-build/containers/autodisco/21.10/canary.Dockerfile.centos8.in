# Base information.
FROM @CENTREON_WEB_IMAGE@
LABEL maintainer="Kevin Duret <kduret@centreon.com>"

# Install package.
RUN dnf config-manager --disablerepo centreon-\* && \
    dnf config-manager --enablerepo  centreon-canary-noarch && \
    dnf config-manager --enablerepo  centreon-canary && \
    dnf install -y centreon-auto-discovery-server centreon-license-manager && \
    dnf clean all

# Install module in Centreon.
COPY web/21.10/install-centreon-module.php /tmp/install-centreon-module.php
COPY autodisco/21.10/install.sh /tmp/install.sh
RUN chmod +x /tmp/install-centreon-module.php /tmp/install.sh && \
    /tmp/install.sh

# License.
COPY ppm/epp.license.offline /etc/centreon/license.d/epp.license
