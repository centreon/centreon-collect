<?xml version="1.0" encoding="UTF-8"?>
<robot generator="Robot 7.0 (Python 3.8.17 on linux)" generated="2024-02-15T14:35:42.841750" rpa="false" schemaversion="5">
<suite id="s1" name="Tests" source="/root/centreon-collect/tests">
<suite id="s1-s1" name="Broker-Engine" source="/root/centreon-collect/tests/broker-engine">
<suite id="s1-s1-s1" name="Services" source="/root/centreon-collect/tests/broker-engine/services.robot">
<kw name="Clean Before Suite" owner="resources" type="SETUP">
<kw name="Clear Db" owner="Common">
<arg>resources</arg>
<status status="PASS" start="2024-02-15T14:35:43.054501" elapsed="0.003832"/>
</kw>
<kw name="Clear Db" owner="Common">
<arg>hosts</arg>
<status status="PASS" start="2024-02-15T14:35:43.058601" elapsed="0.001604"/>
</kw>
<kw name="Clear Db" owner="Common">
<arg>services</arg>
<status status="PASS" start="2024-02-15T14:35:43.060452" elapsed="0.001163"/>
</kw>
<kw name="Clear Db" owner="Common">
<arg>tags</arg>
<status status="PASS" start="2024-02-15T14:35:43.061803" elapsed="0.001059"/>
</kw>
<kw name="Stop Processes" owner="resources">
<kw name="Terminate All Processes" owner="Process">
<arg>kill=True</arg>
<doc>Terminates all still running processes started by this library.</doc>
<status status="PASS" start="2024-02-15T14:35:43.063441" elapsed="0.000516"/>
</kw>
<kw name="Kill Broker" owner="Common">
<status status="PASS" start="2024-02-15T14:35:43.064120" elapsed="0.033721"/>
</kw>
<kw name="Kill Engine" owner="Common">
<status status="PASS" start="2024-02-15T14:35:43.098697" elapsed="0.018309"/>
</kw>
<status status="PASS" start="2024-02-15T14:35:43.063135" elapsed="0.054289"/>
</kw>
<kw name="Clear Engine Logs" owner="resources">
<kw name="Remove Directory" owner="OperatingSystem">
<msg time="2024-02-15T14:35:43.119651" level="INFO" html="true">Removed directory '&lt;a href="file:///tmp/var/log/centreon-engine"&gt;/tmp/var/log/centreon-engine&lt;/a&gt;'.</msg>
<arg>${ENGINE_LOG}</arg>
<arg>Recursive=True</arg>
<doc>Removes the directory pointed to by the given ``path``.</doc>
<status status="PASS" start="2024-02-15T14:35:43.118660" elapsed="0.001144"/>
</kw>
<kw name="Create Directory" owner="OperatingSystem">
<msg time="2024-02-15T14:35:43.120308" level="INFO" html="true">Created directory '&lt;a href="file:///tmp/var/log/centreon-engine"&gt;/tmp/var/log/centreon-engine&lt;/a&gt;'.</msg>
<arg>${ENGINE_LOG}</arg>
<doc>Creates the specified directory.</doc>
<status status="PASS" start="2024-02-15T14:35:43.120024" elapsed="0.000501"/>
</kw>
<status status="PASS" start="2024-02-15T14:35:43.118053" elapsed="0.002570"/>
</kw>
<kw name="Clear Broker Logs" owner="resources">
<kw name="Remove Directory" owner="OperatingSystem">
<msg time="2024-02-15T14:35:43.122081" level="INFO" html="true">Removed directory '&lt;a href="file:///tmp/var/log/centreon-broker"&gt;/tmp/var/log/centreon-broker&lt;/a&gt;'.</msg>
<arg>${BROKER_LOG}</arg>
<arg>Recursive=True</arg>
<doc>Removes the directory pointed to by the given ``path``.</doc>
<status status="PASS" start="2024-02-15T14:35:43.121133" elapsed="0.001049"/>
</kw>
<kw name="Create Directory" owner="OperatingSystem">
<msg time="2024-02-15T14:35:43.122706" level="INFO" html="true">Created directory '&lt;a href="file:///tmp/var/log/centreon-broker"&gt;/tmp/var/log/centreon-broker&lt;/a&gt;'.</msg>
<arg>${BROKER_LOG}</arg>
<doc>Creates the specified directory.</doc>
<status status="PASS" start="2024-02-15T14:35:43.122400" elapsed="0.000388"/>
</kw>
<status status="PASS" start="2024-02-15T14:35:43.120839" elapsed="0.002046"/>
</kw>
<status status="PASS" start="2024-02-15T14:35:43.053094" elapsed="0.069887"/>
</kw>
<test id="s1-s1-s1-t1" name="service" line="21">
<kw name="Stop Processes" owner="resources" type="SETUP">
<kw name="Terminate All Processes" owner="Process">
<arg>kill=True</arg>
<doc>Terminates all still running processes started by this library.</doc>
<status status="PASS" start="2024-02-15T14:35:43.125143" elapsed="0.000263"/>
</kw>
<kw name="Kill Broker" owner="Common">
<status status="PASS" start="2024-02-15T14:35:43.125568" elapsed="0.032853"/>
</kw>
<kw name="Kill Engine" owner="Common">
<status status="PASS" start="2024-02-15T14:35:43.159155" elapsed="0.022721"/>
</kw>
<status status="PASS" start="2024-02-15T14:35:43.124790" elapsed="0.057489"/>
</kw>
<kw name="Config Engine" owner="Engine">
<arg>${1}</arg>
<arg>${1}</arg>
<arg>${25}</arg>
<status status="PASS" start="2024-02-15T14:35:43.183421" elapsed="0.003685"/>
</kw>
<kw name="Config Broker" owner="Broker">
<arg>rrd</arg>
<status status="PASS" start="2024-02-15T14:35:43.187724" elapsed="0.000477"/>
</kw>
<kw name="Config Broker" owner="Broker">
<arg>central</arg>
<status status="PASS" start="2024-02-15T14:35:43.188558" elapsed="0.000435"/>
</kw>
<kw name="Config Broker" owner="Broker">
<arg>module</arg>
<arg>${1}</arg>
<status status="PASS" start="2024-02-15T14:35:43.189400" elapsed="0.001036"/>
</kw>
<kw name="Config BBDO3" owner="resources">
<kw name="Config Broker Sql Output" owner="Broker">
<arg>central</arg>
<arg>unified_sql</arg>
<status status="PASS" start="2024-02-15T14:35:43.191501" elapsed="0.001221"/>
</kw>
<kw name="Broker Config Add Item" owner="Broker">
<arg>rrd</arg>
<arg>bbdo_version</arg>
<arg>${version}</arg>
<status status="PASS" start="2024-02-15T14:35:43.192974" elapsed="0.000636"/>
</kw>
<kw name="Broker Config Add Item" owner="Broker">
<arg>central</arg>
<arg>bbdo_version</arg>
<arg>${version}</arg>
<status status="PASS" start="2024-02-15T14:35:43.194220" elapsed="0.000805"/>
</kw>
<for flavor="IN RANGE">
<iter>
<kw name="Catenate" owner="BuiltIn">
<msg time="2024-02-15T14:35:43.196041" level="INFO">${mod} = module0</msg>
<var>${mod}</var>
<arg>SEPARATOR=</arg>
<arg>module</arg>
<arg>${i}</arg>
<doc>Catenates the given items together and returns the resulted string.</doc>
<status status="PASS" start="2024-02-15T14:35:43.195685" elapsed="0.000400"/>
</kw>
<kw name="Broker Config Add Item" owner="Broker">
<arg>${mod}</arg>
<arg>bbdo_version</arg>
<arg>${version}</arg>
<status status="PASS" start="2024-02-15T14:35:43.196327" elapsed="0.000523"/>
</kw>
<var name="${i}">0</var>
<status status="PASS" start="2024-02-15T14:35:43.195504" elapsed="0.001405"/>
</iter>
<var>${i}</var>
<value>${nbEngine}</value>
<status status="PASS" start="2024-02-15T14:35:43.195155" elapsed="0.001796"/>
</for>
<arg>1</arg>
<status status="PASS" start="2024-02-15T14:35:43.190925" elapsed="0.006108"/>
</kw>
<kw name="Broker Config Log" owner="Broker">
<arg>central</arg>
<arg>sql</arg>
<arg>debug</arg>
<status status="PASS" start="2024-02-15T14:35:43.197377" elapsed="0.000587"/>
</kw>
<kw name="Broker Config Log" owner="Broker">
<arg>module0</arg>
<arg>neb</arg>
<arg>trace</arg>
<status status="PASS" start="2024-02-15T14:35:43.198215" elapsed="0.000474"/>
</kw>
<kw name="Config Broker Sql Output" owner="Broker">
<arg>central</arg>
<arg>unified_sql</arg>
<status status="PASS" start="2024-02-15T14:35:43.199019" elapsed="0.000541"/>
</kw>
<kw name="Get Current Date" owner="DateTime">
<msg time="2024-02-15T14:35:43.200150" level="INFO">${start} = 2024-02-15 14:35:43.200</msg>
<var>${start}</var>
<doc>Returns current local or UTC time with an optional increment.</doc>
<status status="PASS" start="2024-02-15T14:35:43.199862" elapsed="0.000321"/>
</kw>
<kw name="Start Broker" owner="resources">
<kw name="Start Process" owner="Process">
<msg time="2024-02-15T14:35:43.201570" level="INFO">Starting process:
/usr/sbin/cbd /tmp/etc/centreon-broker/central-broker.json</msg>
<arg>/usr/sbin/cbd</arg>
<arg>${EtcRoot}/centreon-broker/central-broker.json</arg>
<arg>alias=b1</arg>
<doc>Starts a new process on background.</doc>
<status status="PASS" start="2024-02-15T14:35:43.201178" elapsed="0.006806"/>
</kw>
<if>
<branch type="IF" condition="not ${only_central}">
<kw name="Start Process" owner="Process">
<msg time="2024-02-15T14:35:43.210800" level="INFO">Starting process:
/usr/sbin/cbd /tmp/etc/centreon-broker/central-rrd.json</msg>
<arg>/usr/sbin/cbd</arg>
<arg>${EtcRoot}/centreon-broker/central-rrd.json</arg>
<arg>alias=b2</arg>
<doc>Starts a new process on background.</doc>
<status status="PASS" start="2024-02-15T14:35:43.210080" elapsed="0.021702"/>
</kw>
<status status="PASS" start="2024-02-15T14:35:43.208971" elapsed="0.023413"/>
</branch>
<status status="PASS" start="2024-02-15T14:35:43.208715" elapsed="0.023791"/>
</if>
<status status="PASS" start="2024-02-15T14:35:43.200629" elapsed="0.032145"/>
</kw>
<kw name="Start Engine" owner="resources">
<kw name="Get Engines Count" owner="Engine">
<msg time="2024-02-15T14:35:43.236332" level="INFO">${count} = 1</msg>
<var>${count}</var>
<status status="PASS" start="2024-02-15T14:35:43.235445" elapsed="0.000984"/>
</kw>
<for flavor="IN RANGE">
<iter>
<kw name="Catenate" owner="BuiltIn">
<msg time="2024-02-15T14:35:43.245894" level="INFO">${alias} = e0</msg>
<var>${alias}</var>
<arg>SEPARATOR=</arg>
<arg>e</arg>
<arg>${idx}</arg>
<doc>Catenates the given items together and returns the resulted string.</doc>
<status status="PASS" start="2024-02-15T14:35:43.245308" elapsed="0.002681"/>
</kw>
<kw name="Catenate" owner="BuiltIn">
<msg time="2024-02-15T14:35:43.248929" level="INFO">${conf} = /tmp/etc/centreon-engine/config0/centengine.cfg</msg>
<var>${conf}</var>
<arg>SEPARATOR=</arg>
<arg>${EtcRoot}</arg>
<arg>/centreon-engine/config</arg>
<arg>${idx}</arg>
<arg>/centengine.cfg</arg>
<doc>Catenates the given items together and returns the resulted string.</doc>
<status status="PASS" start="2024-02-15T14:35:43.248428" elapsed="0.000553"/>
</kw>
<kw name="Catenate" owner="BuiltIn">
<msg time="2024-02-15T14:35:43.253952" level="INFO">${log} = /tmp/var/log/centreon-engine/config0</msg>
<var>${log}</var>
<arg>SEPARATOR=</arg>
<arg>${VarRoot}</arg>
<arg>/log/centreon-engine/config</arg>
<arg>${idx}</arg>
<doc>Catenates the given items together and returns the resulted string.</doc>
<status status="PASS" start="2024-02-15T14:35:43.251472" elapsed="0.002537"/>
</kw>
<kw name="Catenate" owner="BuiltIn">
<msg time="2024-02-15T14:35:43.254775" level="INFO">${lib} = /tmp/var/lib/centreon-engine/config0</msg>
<var>${lib}</var>
<arg>SEPARATOR=</arg>
<arg>${VarRoot}</arg>
<arg>/lib/centreon-engine/config</arg>
<arg>${idx}</arg>
<doc>Catenates the given items together and returns the resulted string.</doc>
<status status="PASS" start="2024-02-15T14:35:43.254327" elapsed="0.000493"/>
</kw>
<kw name="Create Directory" owner="OperatingSystem">
<msg time="2024-02-15T14:35:43.258316" level="INFO" html="true">Created directory '&lt;a href="file:///tmp/var/log/centreon-engine/config0"&gt;/tmp/var/log/centreon-engine/config0&lt;/a&gt;'.</msg>
<arg>${log}</arg>
<doc>Creates the specified directory.</doc>
<status status="PASS" start="2024-02-15T14:35:43.257737" elapsed="0.000719"/>
</kw>
<kw name="Create Directory" owner="OperatingSystem">
<msg time="2024-02-15T14:35:43.259079" level="INFO" html="true">Directory '&lt;a href="file:///tmp/var/lib/centreon-engine/config0"&gt;/tmp/var/lib/centreon-engine/config0&lt;/a&gt;' already exists.</msg>
<arg>${lib}</arg>
<doc>Creates the specified directory.</doc>
<status status="PASS" start="2024-02-15T14:35:43.258747" elapsed="0.000427"/>
</kw>
<try>
<branch type="TRY">
<kw name="Remove File" owner="OperatingSystem">
<msg time="2024-02-15T14:35:43.262134" level="FAIL">Path '/tmp/var/lib/centreon-engine/config0/rw/centengine.cmd' is not a file.</msg>
<arg>${lib}/rw/centengine.cmd</arg>
<doc>Removes a file with the given path.</doc>
<status status="FAIL" start="2024-02-15T14:35:43.261062" elapsed="0.001293">Path '/tmp/var/lib/centreon-engine/config0/rw/centengine.cmd' is not a file.</status>
</kw>
<status status="FAIL" start="2024-02-15T14:35:43.260785" elapsed="0.001734">Path '/tmp/var/lib/centreon-engine/config0/rw/centengine.cmd' is not a file.</status>
</branch>
<branch type="EXCEPT">
<kw name="Log" owner="BuiltIn">
<msg time="2024-02-15T14:35:43.263331" level="INFO">can't remove /tmp/var/lib/centreon-engine/config0/rw/centengine.cmd don't worry</msg>
<arg>can't remove ${lib}/rw/centengine.cmd don't worry</arg>
<doc>Logs the given message with the given level.</doc>
<status status="PASS" start="2024-02-15T14:35:43.262981" elapsed="0.000469"/>
</kw>
<status status="PASS" start="2024-02-15T14:35:43.262714" elapsed="0.000803"/>
</branch>
<status status="PASS" start="2024-02-15T14:35:43.259310" elapsed="0.004345"/>
</try>
<kw name="Start Process" owner="Process">
<msg time="2024-02-15T14:35:43.264418" level="INFO">Starting process:
/usr/sbin/centengine /tmp/etc/centreon-engine/config0/centengine.cfg</msg>
<arg>/usr/sbin/centengine</arg>
<arg>${conf}</arg>
<arg>alias=${alias}</arg>
<doc>Starts a new process on background.</doc>
<status status="PASS" start="2024-02-15T14:35:43.263918" elapsed="0.020531"/>
</kw>
<var name="${idx}">0</var>
<status status="PASS" start="2024-02-15T14:35:43.244938" elapsed="0.039902"/>
</iter>
<var>${idx}</var>
<value>0</value>
<value>${count}</value>
<status status="PASS" start="2024-02-15T14:35:43.236577" elapsed="0.048383"/>
</for>
<status status="PASS" start="2024-02-15T14:35:43.234214" elapsed="0.051214"/>
</kw>
<kw name="Create List" owner="BuiltIn">
<msg time="2024-02-15T14:35:43.291979" level="INFO">${content} = ['check_for_external_commands()']</msg>
<var>${content}</var>
<arg>check_for_external_commands()</arg>
<doc>Returns a list containing given items.</doc>
<status status="PASS" start="2024-02-15T14:35:43.286734" elapsed="0.005361"/>
</kw>
<kw name="Find In Log With Timeout" owner="Common">
<msg time="2024-02-15T14:35:43.293656" level="INFO">regex=False</msg>
<msg time="2024-02-15T14:35:48.299842" level="INFO">regex=False</msg>
<msg time="2024-02-15T14:35:48.301340" level="INFO">${result} = True</msg>
<var>${result}</var>
<arg>${engineLog0}</arg>
<arg>${start}</arg>
<arg>${content}</arg>
<arg>60</arg>
<status status="PASS" start="2024-02-15T14:35:43.292660" elapsed="5.008752"/>
</kw>
<kw name="Should Be True" owner="BuiltIn">
<arg>${result}</arg>
<arg>A message telling check_for_external_commands() should be available.</arg>
<doc>Fails if the given condition is not true.</doc>
<status status="PASS" start="2024-02-15T14:35:48.301815" elapsed="0.000340"/>
</kw>
<kw name="Save Logs If Failed" owner="resources" type="TEARDOWN">
<kw name="Run Keyword If Test Failed" owner="BuiltIn">
<arg>Save Logs</arg>
<doc>Runs the given keyword with the given arguments, if the test failed.</doc>
<status status="PASS" start="2024-02-15T14:35:48.303254" elapsed="0.000146"/>
</kw>
<status status="PASS" start="2024-02-15T14:35:48.302739" elapsed="0.000733"/>
</kw>
<doc>The check attempts and the max check attempts of (host_1,service_1) are changed to 280 thanks to the retention.dat file. Then engine and broker are started and broker should write these values in the services and resources tables. We only test the services table because we need a resources table that allows bigger numbers for these two attributes. But we see that broker doesn't crash anymore.</doc>
<tag>MON-18531</tag>
<tag>MON-35339</tag>
<tag>MON-35375</tag>
<status status="PASS" start="2024-02-15T14:35:43.123174" elapsed="5.180412"/>
</test>
<kw name="Clean After Suite" owner="resources" type="TEARDOWN">
<kw name="Terminate All Processes" owner="Process">
<msg time="2024-02-15T14:35:48.305050" level="INFO">Forcefully killing process.</msg>
<msg time="2024-02-15T14:35:48.405517" level="INFO">Process completed.</msg>
<msg time="2024-02-15T14:35:48.405650" level="INFO">Forcefully killing process.</msg>
<msg time="2024-02-15T14:35:48.506057" level="INFO">Process completed.</msg>
<msg time="2024-02-15T14:35:48.506188" level="INFO">Forcefully killing process.</msg>
<msg time="2024-02-15T14:35:48.606694" level="INFO">Process completed.</msg>
<arg>kill=True</arg>
<doc>Terminates all still running processes started by this library.</doc>
<status status="PASS" start="2024-02-15T14:35:48.304836" elapsed="0.302206"/>
</kw>
<status status="PASS" start="2024-02-15T14:35:48.304508" elapsed="0.302678"/>
</kw>
<doc>Centreon Broker and Engine progressively add services</doc>
<status status="PASS" start="2024-02-15T14:35:42.869198" elapsed="5.738025"/>
</suite>
<status status="PASS" start="2024-02-15T14:35:42.867745" elapsed="5.740674"/>
</suite>
<status status="PASS" start="2024-02-15T14:35:42.843652" elapsed="5.765435"/>
</suite>
<statistics>
<total>
<stat pass="1" fail="0" skip="0">All Tests</stat>
</total>
<tag>
<stat pass="1" fail="0" skip="0">MON-18531</stat>
<stat pass="1" fail="0" skip="0">MON-35339</stat>
<stat pass="1" fail="0" skip="0">MON-35375</stat>
</tag>
<suite>
<stat pass="1" fail="0" skip="0" id="s1" name="Tests">Tests</stat>
<stat pass="1" fail="0" skip="0" id="s1-s1" name="Broker-Engine">Tests.Broker-Engine</stat>
<stat pass="1" fail="0" skip="0" id="s1-s1-s1" name="Services">Tests.Broker-Engine.Services</stat>
</suite>
</statistics>
<errors>
</errors>
</robot>
